# Project TODO

- [x] Convert original NetEquity.HTML to React app with all formulas preserved
- [x] Apple-level UI/UX redesign (warm gray bg, shadow cards, pill tabs, generous spacing)
- [x] Google-style fonts (Inter/sans-serif everywhere, no monospace)
- [x] Blue/white/black brand colors, clean professional financial app look
- [x] Original top-down layout (inputs at top in grid, results below)
- [x] Number formatting with commas every 3 digits
- [x] Save and name simulation scenarios (localStorage)
- [x] Load, rename, delete saved scenarios
- [x] Side-by-side scenario comparison with overlay charts
- [x] Annual expense input (fixed RM or % of purchase price)
- [x] Upgrade to full-stack (web-db-user) for LLM API access
- [x] AI Financial Planner chat backend (tRPC + invokeLLM)
- [x] AI Financial Planner slide-in chat panel UI
- [x] Auto-analyze simulation on chat open
- [x] Floating AI button + header AI button + inline AI button after calculate
- [x] AI tab next to title — grayed/muted before calculation, gradient glow after
- [x] Auto-trigger AI analysis in background immediately on Calculate
- [x] Show "AI is thinking..." loading state in tab and chat
- [x] Clickable recommendation chips after each AI response
- [x] Remove floating AI button and header AI button (replaced by tab)
- [x] Revert AI UX — remove tab navigation, restore slide-in panel from right
- [x] Move AI Financial Planner button next to title "Property Investment Simulator"
- [x] Fix recommendation chips visibility after each AI response
- [x] Add goal-based reverse planner mode (e.g. "I want RM 5M in 15 years")
- [x] Stock reinvestment calculator logic (cashback + cash flow reinvestment)
- [x] Stock input panel (dividend yield, discount, appreciation, DRIP, mortgage amount for cashback)
- [x] Stock results panel (portfolio value, dividends, combined net worth chart)
- [x] Integrate stock section into Home page after property results
- [x] Fix stock appreciation timing — Year 1 no growth (only discount), appreciation starts Year 2
- [x] Add Assumptions & Calculations explanation tabs to Stock Results panel
- [x] Rename "Cash Flow Invested" to "Property Cash Flow" in stock table
- [x] Add "Dividend Reinvested" column showing last year's dividend reinvested this year
- [x] Update stock Assumptions & Calculations tabs to reflect new columns
- [x] Add Property Net Equity column to stock table for transparent Combined Net Worth calculation
- [x] Add tooltip (?) icons on column headers showing formulas on hover
- [x] Move "Maximum Properties" to Purchase Plan section
- [x] Replace "Below Market Value" toggle + discount % with direct "Current Market Value" input
- [x] Replace "Loan Type" dropdown with direct "Loan Amount (RM)" input in Financial Assumptions
- [x] Change "Annual Expense / Property" to "Monthly Expense / Property" — % based on instalment amount
- [x] Auto-calculate Loan Tenure from age: min(70 - age, 35) — ask for user's age
- [x] Add explanation note: tool assumes same price, market value, and financial assumptions for all properties
- [x] Update calculator types and logic for new inputs
- [x] Update ResultsPanel, CompareScenarios, SavedScenarios for new field names
- [x] Pass stock results and inputs to AIChatPanel from Home.tsx
- [x] Update AIChatPanel context builder to include stock portfolio data
- [x] Update AI system prompt to analyze combined property + stock portfolio
- [x] Add stock-related recommendation chips
- [x] Re-trigger AI analysis when stock results are calculated
- [x] Include combined net worth, stock portfolio value, dividends in AI context
- [x] Update goal-based reverse planner to consider stock portfolio adjustments
- [x] Add vitest for stock portfolio data in AI system prompt
- [x] Add cash flow + cashback summary table below property charts
- [x] Add "Reinvest to Stock" button below the summary table
- [x] Restructure into 3 top-level tabs: Property Investment / Stock Investment / Combined Portfolio
- [x] "Reinvest to Stock" button switches to Stock Investment tab
- [x] Build Combined Portfolio tab with merged property + stock data
